<!--Api http://bootstrap-table.wenzhixin.net.cn/documentation/ -->

<style>
    .tableContent {
        text-align: center
    }
    .error{
        background-color: red
    }
    .notification{
        background-color: #66ff33
    }
    .caution{
        background-color: yellow
    }
    .table-hover tbody tr:hover > td {
        cursor: pointer;
    }
    .table-hover tbody tr:hover td {
        background-color: inherit;
    }
</style>

<table id="alertNotificationTable" class="tableContent"></table>

<script type="text/javascript">

    api.server.getAlertsSendToDutyOfficer();

    function getDataCallback(response) {
        var data = JSON.parse(response);
        var dataSource = [];
        if (data) {
            data.forEach(function (element, index) {
                dataSource.push({
                    source: element.Subject,
                    type: element.Type,
                    dateTime: element.Date,
                    message: element.Content
                });
            });
        }
       var Type = {
            Code : {
                error : 0,
                notification : 1,
                caution : 2
            },
            Message : {
                error : "Error",
                notification : "Notification",
                caution : "Caution"
            } 
        };

        var rowStyle = function (row, index) {
            var type = row.type;
            switch (type) {
                case Type.Code.error:
                    return {
                        classes: "error"
                    };
                case Type.Code.notification:
                    return {
                        classes: "notification"
                    };
                case Type.Code.caution:
                    return {
                        classes: "caution"
                    };
            }
            return {};
        }

        $('#alertNotificationTable').bootstrapTable({
            pagination: true,
            search: true,
            pageSize: 10,
            columns: [{
                field: 'source',
                title: 'Source',
                sortable: true,
                halign: "center"
            }, {
                field: 'type',
                title: 'Type',
                sortable: true,
                halign: "center",
                formatter : function (value, row, index, field) {
                    switch (value) {
                        case Type.Code.error:
                            return Type.Message.error;
                        case Type.Code.notification:
                            return Type.Message.notification;
                        case Type.Code.caution:
                            return Type.Message.caution;
                    }
                }
            }, {
                field: 'dateTime',
                title: 'Date/Time',
                sortable: true,
                halign: "center"
            }, {
                field: 'message',
                title: 'Message',
                sortable: false,
                halign: "center"
            }],
            data: dataSource,
            rowStyle: rowStyle,
            onDblClickRow: onRowDblClick
        });

        function onRowDblClick(row, index) {
            var data = JSON.stringify(row);
            api.server.LoadPopupAlert(data, function () {
                $('#alertPopup').modal();
            });
        }
    };
    activemenu('Alerts');

</script>