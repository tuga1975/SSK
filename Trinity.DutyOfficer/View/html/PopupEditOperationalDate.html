<style>
    hr {
        display: block;
        height: 1px;
        border: 0;
        border-top: 1px solid #ccc;
        margin: 1em 0;
        padding: 0;
    }
</style>
<div class="modal fade" role="dialog" id="idEditOperationalDate">
    <div class="modal-dialog modal-sm" style="width:65%;">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Edit Operational Date</h5>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <div class="form-inline" style="margin-bottom:10px;">
                        <span style="display:inline-block;width:150px;height:33px; padding-top:3px;box-sizing:border-box;border:1px solid #CCC;text-align:center;">Date</span>
                        <select class="form-control" style="width:150px; margin-left:15px;" id="dayOfWeek">
                            <option>Monday</option>
                            <option>Tuesday</option>
                            <option>Wednesday</option>
                            <option>Thurday</option>
                            <option>Friday</option>
                            <option>Saturday</option>
                            <option>Sunday</option>
                        </select>
                    </div>
                    <hr />
                    <div class="form-inline" style="margin-bottom:20px;">
                        <span class="control-label" style="display:inline-block;width:150px;height:33px; padding-top:3px;box-sizing:border-box;border:1px solid #CCC;text-align:center;">Morning Slots</span>
                        <div style="display:inline-block; float:right;">
                            <span class="control-label" style="display:inline-block;width:110px;height:48px; padding-top:3px;box-sizing:border-box;border:1px solid #CCC;text-align:center; font-size:13px;">Check to<br />close slots</span>
                            <input type="checkbox" class="form-control" id="morning-Closed" />
                        </div>
                    </div>
                    <div class="form-inline" style="margin-bottom:20px;">
                        <span class="control-label" style="display:inline-block;width:110px;height:33px; padding-top:3px;box-sizing:border-box;border:1px solid #CCC;text-align:center;">Start Time</span>
                        <select class="form-control" style="width:70px; margin-left:15px;" id="morning-start-HH"></select> : <select class="form-control" style="width:70px;" id="morning-start-MM"></select> : <select class="form-control" style="width:70px;" id="morning-start-XM"></select>
                        <span class="control-label" style="display:inline-block;width:110px;height:33px; padding-top:3px;box-sizing:border-box;border:1px solid #CCC;text-align:center; margin-left:50px;">End Time</span>
                        <select class="form-control" style="width:70px; margin-left:15px;" id="morning-end-HH"></select> : <select class="form-control" style="width:70px;" id="morning-end-MM"></select> : <select class="form-control" style="width:70px;" id="morning-end-XM"></select>
                    </div>
                    <div class="form-inline" style="margin-bottom:20px;">
                        <span class="control-label" style="display:inline-block;width:180px;height:55px; padding-top:3px;box-sizing:border-box;border:1px solid #CCC;text-align:center;">Maximum Supervisee<br />per timeslot</span>
                        <input type="text" class="form-control" style="width:70px; margin-left:15px;" id="morning-max" />
                        <span class="control-label" style="display:inline-block;width:140px;height:55px; padding-top:3px;box-sizing:border-box;border:1px solid #CCC;text-align:center; margin-left:50px;">Reserved<br />for spare</span>
                        <input type="text" class="form-control" style="width:70px; margin-left:15px;" id="morning-spare" />
                        <span class="control-label" style="display:inline-block;width:120px;height:33px; padding-top:3px;box-sizing:border-box;border:1px solid #CCC;text-align:center; margin-left:50px;">Intervals</span>
                        <select class="form-control" style="width:70px; margin-left:15px;" id="morning-interval"></select>
                    </div>
                    <hr />
                    <div class="form-inline" style="margin-bottom:20px;">
                        <span class="control-label" style="display:inline-block;width:150px;height:33px; padding-top:3px;box-sizing:border-box;border:1px solid #CCC;text-align:center;">Afternoon Slots</span>
                        <div style="display:inline-block; float:right;">
                            <span class="control-label" style="display:inline-block;width:110px;height:48px; padding-top:3px;box-sizing:border-box;border:1px solid #CCC;text-align:center; font-size:13px;">Check to<br />close slots</span>
                            <input type="checkbox" class="form-control" id="afternoon-Closed" />
                        </div>
                    </div>
                    <div class="form-inline" style="margin-bottom:20px;">
                        <span class="control-label" style="display:inline-block;width:110px;height:33px; padding-top:3px;box-sizing:border-box;border:1px solid #CCC;text-align:center;">Start Time</span>
                        <select class="form-control" style="width:70px; margin-left:15px;" id="afternoon-start-HH"></select> : <select class="form-control" style="width:70px;" id="afternoon-start-MM"></select> : <select class="form-control" style="width:70px;" id="afternoon-start-XM"></select>
                        <span class="control-label" style="display:inline-block;width:110px;height:33px; padding-top:3px;box-sizing:border-box;border:1px solid #CCC;text-align:center; margin-left:50px;">End Time</span>
                        <select class="form-control" style="width:70px; margin-left:15px;" id="afternoon-end-HH"></select> : <select class="form-control" style="width:70px;" id="afternoon-end-MM"></select> : <select class="form-control" style="width:70px;" id="afternoon-end-XM"></select>
                    </div>
                    <div class="form-inline" style="margin-bottom:20px;">
                        <span class="control-label" style="display:inline-block;width:180px;height:55px; padding-top:3px;box-sizing:border-box;border:1px solid #CCC;text-align:center;">Maximum Supervisee<br />per timeslot</span>
                        <input type="text" class="form-control" style="width:70px; margin-left:15px;" id="afternoon-max" />
                        <span class="control-label" style="display:inline-block;width:140px;height:55px; padding-top:3px;box-sizing:border-box;border:1px solid #CCC;text-align:center; margin-left:50px;">Reserved<br />for spare</span>
                        <input type="text" class="form-control" style="width:70px; margin-left:15px;" id="afternoon-spare" />
                        <span class="control-label" style="display:inline-block;width:120px;height:33px; padding-top:3px;box-sizing:border-box;border:1px solid #CCC;text-align:center; margin-left:50px;">Intervals</span>
                        <select class="form-control" style="width:70px; margin-left:15px;" id="afternoon-interval"></select>
                    </div>
                    <hr />
                    <div class="form-inline" style="margin-bottom:20px;">
                        <span class="control-label" style="display:inline-block;width:150px;height:33px; padding-top:3px;box-sizing:border-box;border:1px solid #CCC;text-align:center;">Evening Slots</span>
                        <div style="display:inline-block; float:right;">
                            <span class="control-label" style="display:inline-block;width:110px;height:48px; padding-top:3px;box-sizing:border-box;border:1px solid #CCC;text-align:center; font-size:13px;">Check to<br />close slots</span>
                            <input type="checkbox" class="form-control" id="evening-Closed" />
                        </div>
                    </div>
                    <div class="form-inline" style="margin-bottom:20px;">
                        <span class="control-label" style="display:inline-block;width:110px;height:33px; padding-top:3px;box-sizing:border-box;border:1px solid #CCC;text-align:center;">Start Time</span>
                        <select class="form-control" style="width:70px; margin-left:15px;" id="evening-start-HH"></select> : <select class="form-control" style="width:70px;" id="evening-start-MM"></select> : <select class="form-control" style="width:70px;" id="evening-start-XM"></select>
                        <span class="control-label" style="display:inline-block;width:110px;height:33px; padding-top:3px;box-sizing:border-box;border:1px solid #CCC;text-align:center; margin-left:50px;">End Time</span>
                        <select class="form-control" style="width:70px; margin-left:15px;" id="evening-end-HH"></select> : <select class="form-control" style="width:70px;" id="evening-end-MM"></select> : <select class="form-control" style="width:70px;" id="evening-end-XM"></select>
                    </div>
                    <div class="form-inline" style="margin-bottom:20px;">
                        <span class="control-label" style="display:inline-block;width:180px;height:55px; padding-top:3px;box-sizing:border-box;border:1px solid #CCC;text-align:center;">Maximum Supervisee<br />per timeslot</span>
                        <input type="text" class="form-control" style="width:70px; margin-left:15px;" id="evening-max" />
                        <span class="control-label" style="display:inline-block;width:140px;height:55px; padding-top:3px;box-sizing:border-box;border:1px solid #CCC;text-align:center; margin-left:50px;">Reserved<br />for spare</span>
                        <input type="text" class="form-control" style="width:70px; margin-left:15px;" id="evening-spare" />
                        <span class="control-label" style="display:inline-block;width:120px;height:33px; padding-top:3px;box-sizing:border-box;border:1px solid #CCC;text-align:center; margin-left:50px;">Intervals</span>
                        <select class="form-control" style="width:70px; margin-left:15px;" id="evening-interval"></select>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-dark" id="EditBtn">Edit</button>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">
    var optionsHH = ["00", "01", "02", "03", "04", "05", "06", "07", "08", "09", "10", "11", "12"];
    var optionsMM = ["00", "05", "10", "15", "20", "25", "30", "35", "40", "45", "50", "55"];
    var optionsXM = ["AM", "PM"];
    var optionsInterval = ["15", "30", "45", "60"];

    $.each(optionsHH, function (i, p) {
        $('#morning-start-HH').append($('<option></option>').val(p).html(p));
        $('#morning-end-HH').append($('<option></option>').val(p).html(p));
        $('#afternoon-start-HH').append($('<option></option>').val(p).html(p));
        $('#afternoon-end-HH').append($('<option></option>').val(p).html(p));
        $('#evening-start-HH').append($('<option></option>').val(p).html(p));
        $('#evening-end-HH').append($('<option></option>').val(p).html(p));
    });

    $.each(optionsMM, function (i, p) {
        $('#morning-start-MM').append($('<option></option>').val(p).html(p));
        $('#morning-end-MM').append($('<option></option>').val(p).html(p));
        $('#afternoon-start-MM').append($('<option></option>').val(p).html(p));
        $('#afternoon-end-MM').append($('<option></option>').val(p).html(p));
        $('#evening-start-MM').append($('<option></option>').val(p).html(p));
        $('#evening-end-MM').append($('<option></option>').val(p).html(p));
    });

    $.each(optionsXM, function (i, p) {
        $('#morning-start-XM').append($('<option></option>').val(p).html(p));
        $('#morning-end-XM').append($('<option></option>').val(p).html(p));
        $('#afternoon-start-XM').append($('<option></option>').val(p).html(p));
        $('#afternoon-end-XM').append($('<option></option>').val(p).html(p));
        $('#evening-start-XM').append($('<option></option>').val(p).html(p));
        $('#evening-end-XM').append($('<option></option>').val(p).html(p));
    });

    $.each(optionsInterval, function (i, p) {
        $('#morning-interval').append($('<option></option>').val(p).html(p));
        $('#afternoon-interval').append($('<option></option>').val(p).html(p));
        $('#evening-interval').append($('<option></option>').val(p).html(p));
    });

    api.ready(function (response) {
        var model = JSON.parse(response);
        switch (model.DayOfWeek) {
            case 2:
                $('#dayOfWeek').val('Monday');
                break;
            case 3:
                $('#dayOfWeek').val('Tuesday');
                break;
            case 4:
                $('#dayOfWeek').val('Wednesday');
                break;
            case 5:
                $('#dayOfWeek').val('Thurday');
                break;
            case 6:
                $('#dayOfWeek').val('Friday');
                break;
            case 7:
                $('#dayOfWeek').val('Saturday');
                break;
            case 8:
                $('#dayOfWeek').val('Sunday');
                break;
            default:
                $('#dayOfWeek').val('Monday');
                break;
        }

        if (model.Morning_Open_Time) {
            var morningStart = model.Morning_Open_Time.split(':');
            var H = +morningStart[0];
            var h = H % 12 || 12;
            if (h < 10) h = "0" + h;
            var ampm = (H < 12 || H === 24) ? "AM" : "PM";

            $('#morning-start-HH').val(h);
            $('#morning-start-MM').val(morningStart[1]);
            $('#morning-start-XM').val(ampm);
        }

        if (model.Morning_Close_Time) {
            var morningEnd = model.Morning_Close_Time.split(':');
            var H = +morningEnd[0];
            var h = H % 12 || 12;
            if (h < 10) h = "0" + h;
            var ampm = (H < 12 || H === 24) ? "AM" : "PM";

            $('#morning-end-HH').val(h);
            $('#morning-end-MM').val(morningEnd[1]);
            $('#morning-end-XM').val(ampm);
        }

        $('#morning-max').val(model.Morning_MaximumSupervisee);
        $('#morning-spare').val(model.Morning_Spare_Slots);
        $('#morning-interval').val(model.Morning_Interval);
        $('#morning-Closed').prop('checked', model.Morning_Is_Closed);

        setEnableControls('morning', model.Morning_Is_Closed);

        //Afternoon
        if (model.Afternoon_Open_Time) {
            var afternoonStart = model.Afternoon_Open_Time.split(':');
            var H = +afternoonStart[0];
            var h = H % 12 || 12;
            if (h < 10) h = "0" + h;
            var ampm = (H < 12 || H === 24) ? "AM" : "PM";

            $('#afternoon-start-HH').val(h);
            $('#afternoon-start-MM').val(afternoonStart[1]);
            $('#afternoon-start-XM').val(ampm);
        }

        if (model.Afternoon_Close_Time) {
            var afternoonEnd = model.Afternoon_Close_Time.split(':');
            var H = +afternoonEnd[0];
            var h = H % 12 || 12;
            if (h < 10) h = "0" + h;
            var ampm = (H < 12 || H === 24) ? "AM" : "PM";

            $('#afternoon-end-HH').val(h);
            $('#afternoon-end-MM').val(afternoonEnd[1]);
            $('#afternoon-end-XM').val(ampm);
        }

        $('#afternoon-max').val(model.Afternoon_MaximumSupervisee);
        $('#afternoon-spare').val(model.Afternoon_Spare_Slots);
        $('#afternoon-interval').val(model.Afternoon_Interval);
        $('#afternoon-Closed').prop('checked', model.Afternoon_Is_Closed);

        setEnableControls('afternoon', model.Afternoon_Is_Closed);

        //Evening
        if (model.Evening_Open_Time) {
            var eveningStart = model.Evening_Open_Time.split(':');
            var H = +eveningStart[0];
            var h = H % 12 || 12;
            if (h < 10) h = "0" + h;
            var ampm = (H < 12 || H === 24) ? "AM" : "PM";

            $('#evening-start-HH').val(h);
            $('#evening-start-MM').val(eveningStart[1]);
            $('#evening-start-XM').val(ampm);
        }

        if (model.Evening_Close_Time) {
            var eveningEnd = model.Evening_Close_Time.split(':');
            var H = +eveningEnd[0];
            var h = H % 12 || 12;
            if (h < 10) h = "0" + h;
            var ampm = (H < 12 || H === 24) ? "AM" : "PM";

            $('#evening-end-HH').val(h);
            $('#evening-end-MM').val(eveningEnd[1]);
            $('#evening-end-XM').val(ampm);
        }

        $('#evening-max').val(model.Evening_MaximumSupervisee);
        $('#evening-spare').val(model.Evening_Spare_Slots);
        $('#evening-interval').val(model.Evening_Interval);
        $('#evening-Closed').prop('checked', model.Evening_Is_Closed);

        setEnableControls('evening', model.Evening_Is_Closed);
    });

    function setEnableControls(category, isClosed) {
        if (category == 'morning') {
            $('#morning-start-HH').prop('disabled', isClosed);
            $('#morning-start-MM').prop('disabled', isClosed);
            $('#morning-start-XM').prop('disabled', isClosed);
            $('#morning-end-HH').prop('disabled', isClosed);
            $('#morning-end-MM').prop('disabled', isClosed);
            $('#morning-end-XM').prop('disabled', isClosed);
            $('#morning-max').prop('disabled', isClosed);
            $('#morning-spare').prop('disabled', isClosed);
            $('#morning-interval').prop('disabled', isClosed);
        }
        else if (category == 'afternoon') {
            $('#afternoon-start-HH').prop('disabled', isClosed);
            $('#afternoon-start-MM').prop('disabled', isClosed);
            $('#afternoon-start-XM').prop('disabled', isClosed);
            $('#afternoon-end-HH').prop('disabled', isClosed);
            $('#afternoon-end-MM').prop('disabled', isClosed);
            $('#afternoon-end-XM').prop('disabled', isClosed);
            $('#afternoon-max').prop('disabled', isClosed);
            $('#afternoon-spare').prop('disabled', isClosed);
            $('#afternoon-interval').prop('disabled', isClosed);
        }
        else if (category == 'evening') {
            $('#evening-start-HH').prop('disabled', isClosed);
            $('#evening-start-MM').prop('disabled', isClosed);
            $('#evening-start-XM').prop('disabled', isClosed);
            $('#evening-end-HH').prop('disabled', isClosed);
            $('#evening-end-MM').prop('disabled', isClosed);
            $('#evening-end-XM').prop('disabled', isClosed);
            $('#evening-max').prop('disabled', isClosed);
            $('#evening-spare').prop('disabled', isClosed);
            $('#evening-interval').prop('disabled', isClosed);
        }
    }

    $('#morning-Closed').change(function () {
        setEnableControls('morning', $('#morning-Closed').is(":checked"));
    });

    $('#afternoon-Closed').change(function () {
        setEnableControls('afternoon', $('#afternoon-Closed').is(":checked"));
    });

    $('#evening-Closed').change(function () {
        setEnableControls('evening', $('#evening-Closed').is(":checked"));
    });

    var operationSetting;
    $("#EditBtn").click(function (e) {
        var dayOfWeek;
        switch ($('#dayOfWeek').val()) {
            case "Monday":
                dayOfWeek = 2;
                break;
            case "Tuesday":
                dayOfWeek = 3;
                break;
            case "Wednesday":
                dayOfWeek = 4;
                break;
            case "Thurday":
                dayOfWeek = 5;
                break;
            case "Friday":
                dayOfWeek = 6;
                break;
            case "Saturday":
                dayOfWeek = 7;
                break;
            case "Sunday":
                dayOfWeek = 8;
                break;
            default:
                dayOfWeek = 0;
        }

        var morningStart = $('#morning-start-HH').val() + ':' + $('#morning-start-MM').val();//+ ':' + $("#morning-start-XM").val();
        var morningEnd = $('#morning-end-HH').val() + ':' + $('#morning-end-MM').val();//+ ':' + $("#morning-end-XM").val();
        var afternoonStart = $('#afternoon-start-HH').val() + ':' + $('#afternoon-start-MM').val();// + ':' + $("#afternoon-start-XM").val();
        var afternoonEnd = $('#afternoon-end-HH').val() + ':' + $('#afternoon-end-MM').val();// + ':' + $("#afternoon-end-XM").val();
        var eveningStart = $('#evening-start-HH').val() + ':' + $('#evening-start-MM').val();// + ':' + $("#evening-start-XM").val();
        var eveningEnd = $('#evening-end-HH').val() + ':' + $('#evening-end-MM').val();//+ ':' + $("#evening-end-XM").val();

        var model = {
            DayOfWeek: dayOfWeek,
            Morning_Open_Time: convert12To24H(morningStart, $("#morning-start-XM").val()),
            Morning_Close_Time: convert12To24H(morningEnd, $("#morning-end-XM").val()),
            Morning_MaximumSupervisee: $('#morning-max').val(),
            Morning_Spare_Slots: $('#morning-spare').val(),
            Morning_Interval: $('#morning-interval').val(),
            Morning_Is_Closed: $('#morning-Closed').is(":checked"),
            Afternoon_Open_Time: convert12To24H(afternoonStart, $("#afternoon-start-XM").val()),
            Afternoon_Close_Time: convert12To24H(afternoonEnd, $("#afternoon-start-XM").val()),
            Afternoon_MaximumSupervisee: $('#afternoon-max').val(),
            Afternoon_Spare_Slots: $('#afternoon-spare').val(),
            Afternoon_Interval: $('#afternoon-interval').val(),
            Afternoon_Is_Closed: $('#afternoon-Closed').is(":checked"),
            Evening_Open_Time: convert12To24H(eveningStart, $("#evening-start-XM").val()),
            Evening_Close_Time: convert12To24H(eveningEnd, $("#evening-start-XM").val()),
            Evening_MaximumSupervisee: $('#evening-max').val(),
            Evening_Spare_Slots: $('#evening-spare').val(),
            Evening_Interval: $('#evening-interval').val(),
            Evening_Is_Closed: $('#evening-Closed').is(":checked")
        };
        operationSetting = model;

        var data = JSON.stringify(model);
        api.server.CheckWarningSaveSetting(model.DayOfWeek, function (check) {
            if (check == true) {
                api.server.UpdateOperationSetting(data, function () {
                    $('#idEditOperationalDate').modal('toggle');
                });
            }
            else {
                api.server.UpdateOperationSetting(data, function () {
                    api.server.LoadPage('Settings.html');
                    $('#idEditOperationalDate').modal('toggle');
                });
            };
        });

        e.preventDefault();
    });

    function convert12To24H(time, AMPM) {
        var hours = Number(time.match(/^(\d+)/)[1]);
        var minutes = Number(time.match(/:(\d+)/)[1]);
        if (AMPM == "PM" && hours < 12) hours = hours + 12;
        if (AMPM == "AM" && hours == 12) hours = hours - 12;
        var sHours = hours.toString();
        var sMinutes = minutes.toString();
        if (hours < 10) sHours = "0" + sHours;
        if (minutes < 10) sMinutes = "0" + sMinutes;

        return hours + ":" + sMinutes;
    }
</script>