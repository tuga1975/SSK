<div class="container">
    <div class="header-landingPage">
        <h3>Supervisees</h3>
        <a href=""><img class="logout" src="/images/log-out.html"></a>
        <div class="clear"></div>
    </div>
    <div class="list-supervisees">
        <h4>Please scan Supervisees's NRIC or key in Supervisees's NRIC number.</h4>
        <div class="row">
            <div class="col"></div>
            <div class="col-8 list-supervisees-search">
                <form id="searchForm">
                    <input type="text" name="nric" id="nric" placeholder="Please input keyword" />
                    <button type="submit" class="btn-search">Search</button>
                </form>
            </div>
            <div class="col"></div>
        </div>
        <!--<div class="wrap-list">-->
        <table class="table">
            <thead class="thead-dark">
                <tr>
                    <th scope="col">#</th>
                    <th scope="col">Name</th>
                    <th scope="col">NRIC</th>
                    <th scope="col">Date of Birth</th>
                    <th scope="col">Status</th>
                </tr>
            </thead>
            <tbody id="listSupervisee"></tbody>
        </table>
        <!--</div>-->
    </div>
    <button class="btn btn-dark" onclick="api.server.LoadListSupervisee()">Reload</button>
    <button class="btn btn-dark" onclick="api.server.ScanNRIC()">ScanNRIC</button>
</div>

<script>
    $(document).ready(function () {
        if (api.model != null) {

            for (var i = 0; i < api.model.length; i++) {
				var uId = '"' + api.model[i].User.UserId + '"';
                $('#listSupervisee').append("<tr> <th scope='row'>" + (i + 1) + "</th><td>" + api.model[i].User.Name + "</td><td>" + api.model[i].User.NRIC + "</td><td>" + api.model[i].UserProfile.DOB + "</td><td><a href='#' onclick='api.server.EditSupervisee(" + uId + ");'>" + api.model[i].User.Status + "</a></td></tr>");
            }
        }

    });
    $('#searchForm').submit(function myfunction(e) {
        //var $form = $("#searchForm");
        //var data = getFormData($form);
        //var json = JSON.stringify(data);
        if ($.trim($('#nric').val()) != "") {
            api.server.SearchSuperviseeByNRIC($('#nric').val());
        }
        else {
            api.server.LoadListSupervisee();
        }

        e.preventDefault();
    });

    function getFormData($form) {
        var unindexed_array = $form.serializeArray();
        var indexed_array = {};

        $.map(unindexed_array, function (n, i) {
            indexed_array[n['name']] = n['value'];
        });

        return indexed_array;
    }
</script>