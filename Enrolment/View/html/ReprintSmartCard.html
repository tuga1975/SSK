<div style="width:100%;">
	<div class="header header-form-supervisee">
		<img class="logo" src="../images/logo.png" />
        <h3>Reprint Smart Card</h3>
		<div class="clear"></div>
	</div>
	<div class="form-supervisee">
		<form id="superviseeFrm">
			<input class="name-supervisee" type="text" value="Reprint Smart Card" disabled="disabled" />
			<nav class="nav nav-tabs" id="myTab" role="tablist">
				<a class="nav-item nav-link" href="javascript:LoadSuperviseeDetails();">Supervisee Details</a>
				<a class="nav-item nav-link active">Issued Cards</a>
			</nav>
			<div class="tab-content" id="nav-tabContent">
			<div class="tab-pane fade show active" id="issued-cards" role="tabpanel" aria-labelledby="nav-profile-tab">
                <div>
                    <table class="table table-bordered" id="data-issuedcards">
                        <colgroup>

                        </colgroup>
                        <thead>
                            <tr>
                                <th>NRIC</th>
                                <th>Name</th>
                                <th>Issued Date</th>
                                <th>Expired Date</th>
                                <th>Card Number</th>
                                <th>Status</th>
                                <th style="text-align:center;">Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            
                        </tbody>
                    </table>
                    <div enterreprint style="display:none;margin-top:10px;">
                        <span style="height:30px;display:inline-block;vertical-align:middle;box-sizing:border-box;padding:0px 10px;border:1px solid #333;line-height:30px;float:left;">Enter resson to reprint:</span>
                        <input type="text" name="reprint" style="height:30px;display:inline-block;vertical-align:middle;box-sizing:border-box;padding:0px 10px;border:1px solid #333;width:calc(100% - 280px);float:left;margin:0px 10px;"/>
                        <button type="button" style="border:1px solid #333; float:right;" onclick="PriterIssuedCard();">Reprint</button>
                        <div style="clear:both;"></div>
                    </div>
                </div>
			</div>
		</div>
		</form>
	</div>
</div>
<script>
    var UserID = null;
    api.server.GetDataIssuedCards(function (data) {
        UserID = data[1];
        $.each(data[0], function (index, item) {
            $('#data-issuedcards tbody').append(api.DumpDataToTxt('<tr><td>{NRIC}</td><td>{Name}</td><td>{Date_Of_Issue_Txt}</td><td>{Expired_Date_Txt}</td><td>{Serial_Number}</td><td reprintsmartcard-status>{Status}</td><td style="text-align:center;">' + (index == 0 ? '<a href="javascript:ShowPriterIssuedCard();"><img style="cursor:pointer;" src="../images/printer.png"/></a>' : '') + '</td></tr>', item));
        });
    });
    function LoadSuperviseeDetails() {
        api.server.EditSupervisee(UserID);
    }
    function OnPriterIssuedCardCompleted(status,item) {
        if (status) {
            item = JSON.parse(item);
            $('#data-issuedcards tbody [reprintsmartcard-status]').text('Deactivate');
            $('#data-issuedcards tbody td img').remove();
            $('#data-issuedcards tbody').prepend(api.DumpDataToTxt('<tr><td>{NRIC}</td><td>{Name}</td><td>{Date_Of_Issue_Txt}</td><td>{Expired_Date_Txt}</td><td>{Serial_Number}</td><td reprintsmartcard-status>{Status}</td><td  style="text-align:center;"><a href="javascript:ShowPriterIssuedCard();"><img style="cursor:pointer;" src="../images/printer.png"/></a></td></tr>', item))
            $('[enterreprint]').css('display', 'none');
        } else {
            alert('Card enrollment failed. Please try again!');
        }
    }
    function PriterIssuedCard() {
        api.server.PriterIssuedCard($('[name="reprint"]').val());
    }
    function ShowPriterIssuedCard() {
        $('[enterreprint]').css('display', 'block');
    }
</script>